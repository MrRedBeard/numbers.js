function SimpsonDef(n,t,i){var r=(t+i)/2,u=Math.abs(i-t)/6;return u*(n(t)+4*n(r)+n(i))}function SimpsonRecursive(n,t,i,r,u){var f=t+i,e=SimpsonDef(n,t,f),o=SimpsonDef(n,f,i);return Math.abs(e+o-r)<=15*u?e+o+(e+o-r)/15:SimpsonRecursive(n,t,f,u/2,e)+SimpsonRecursive(n,f,i,u/2,o)}var numbers={basic:null,calculus:null,complex:null,dsp:null,matrix:null,prime:null,statistic:null,generate:null,random:null,EPSILON:null},ERROR_MATRIX_NOT_SQUARE,ERROR_VECTOR_NOT_2D,sumNondiagonalElements,rGen;numbers.EPSILON=.001;numbers.basic={sum:null,subtraction:null,product:null,square:null,binomial:null,factorial:null,gcd:null,lcm:null,random:null,shuffle:null,max:null,min:null,range:null,isInt:null,powerMod:null,egcd:null,modInverse:null,numbersEqual:null,fallingFactorial:null,permutation:null};numbers.basic.sum=function(n){var i,t;if(Object.prototype.toString.call(n)==="[object Array]"){for(i=0,t=0;t<n.length;t++)if(typeof n[t]=="number")i=i+n[t];else throw new Error("All elements in array must be numbers");return i}throw new Error("Input must be of type Array");};numbers.basic.subtraction=function(n){var i,t,r;if(Object.prototype.toString.call(n)==="[object Array]"){if(i=n[0],typeof i!="number")throw new Error("All elements in array must be numbers");for(t=1,r=n.length;t<r;t++)if(typeof n[t]=="number")i-=n[t];else throw new Error("All elements in array must be numbers");return i}throw new Error("Input must be of type Array");};numbers.basic.product=function(n){var t,i,r;if(Object.prototype.toString.call(n)==="[object Array]"){if(t=n[0],typeof t!="number")throw new Error("All elements in array must be numbers");for(i=1,r=n.length;i<r;i++)if(typeof n[i]=="number")t=t*n[i];else throw new Error("All elements in array must be numbers");return t}throw new Error("Input must be of type Array");};numbers.basic.square=function(n){if(typeof n!="number")throw new Error("Input must be a number.");else return n*n};numbers.basic.binomial=function(n,t){function r(n,t){if(typeof n!="number"&&typeof t!="number")throw new Error("Input must be a number.");return n>=0&&t===0?1:n===0&&t>0?0:i[n]&&i[n][t]>0?i[n][t]:(i[n]||(i[n]=[]),i[n][t]=r(n-1,t-1)+r(n-1,t),i[n][t])}var i=[];return r(n,t)};numbers.basic.factorial=function(n){if(typeof n!="number")throw new Error("Input must be a number.");if(n<0)throw new Error("Input must not be negative.");for(var t=2,i=1;t<=n;)i*=t++;return i};numbers.basic.gcd=function(n,t){var i;if(n=+n,t=+t,n!==n||t!==t)return NaN;if(n===Infinity||n===-Infinity||t===Infinity||t===-Infinity)return Infinity;if(n%1!=0||t%1!=0)throw new Error("Can only operate on integers");while(t)i=n%t,n=t,t=i;return 0<n?n:-n};numbers.basic.lcm=function(n,t){return Math.abs(n*t)/numbers.basic.gcd(n,t)};numbers.basic.random=function(n,t,i){if(n.length===0)throw new Error("Empty array");else if(t>n.length&&!i)throw new Error("Quantity requested exceeds size of array");if(i===!0){for(var u=[],r=0;r<t;r++)u[r]=n[Math.floor(Math.random()*n.length)];return u}return numbers.basic.shuffle(n).slice(0,t)};numbers.basic.shuffle=function(n){for(var t=n.length,r,i;t;)i=Math.floor(Math.random()*t--),r=n[t],n[t]=n[i],n[i]=r;return n};numbers.basic.max=function(n){var i,t,r,u;if(!Array.isArray(n))throw new Error("Input must be of type Array");for(i=-Infinity,r=0,u=n.length;r<u;r++)if(t=+n[r],i<t&&(i=t),t!==t)return NaN;return i};numbers.basic.min=function(n){var i,t,r,u;if(!Array.isArray(n))throw new Error("Input must be of type Array");for(i=+Infinity,r=0,u=n.length;r<u;r++)if(t=+n[r],t<i&&(i=t),t!==t)return NaN;return i};numbers.basic.range=function(n,t,i){var r,f=0,u;for(arguments.length<=1&&(t=n||0,n=0),i=i||1,t<n&&(i=0-Math.abs(i)),u=Math.max(Math.ceil((t-n)/i)+1,0),r=new Array(u);f<u;)r[f++]=n,n+=i;return r};numbers.basic.isInt=function(n){return n%1==0};numbers.basic.divMod=function(n,t){if(t<=0)throw new Error("b cannot be zero. Undefined.");if(!numbers.basic.isInt(n)||!numbers.basic.isInt(t))throw new Error("A or B are not integers.");return[Math.floor(n/t),n%t]};numbers.basic.powerMod=function(n,t,i){if(typeof n!="number"||typeof t!="number"||typeof i!="number")throw new Error("Inputs must be numbers.");if(t<-1)return Math.pow(n,t)%i;if(t===0)return 1%i;if(t>=1){for(var r=1;t>0;)t%2==1&&(r=r*n%i),n=n*n%i,t=t>>1;return r}return t===-1?numbers.basic.modInverse(n,i):t<1?numbers.basic.powerMod(n,Math.pow(t,-1),i):void 0};numbers.basic.egcd=function(n,t){if(n=+n,t=+t,n!==n||t!==t)return[NaN,NaN,NaN];if(n===Infinity||n===-Infinity||t===Infinity||t===-Infinity)return[Infinity,Infinity,Infinity];if(n%1!=0||t%1!=0)throw new Error("Can only operate on integers");var c=n<0?-1:1,l=t<0?-1:1,i=0,r=1,u=1,f=0,e,o,s,h;for(n=Math.abs(n),t=Math.abs(t);n!==0;)e=Math.floor(t/n),o=t%n,s=i-u*e,h=r-f*e,t=n,n=o,i=u,r=f,u=s,f=h;return[t,c*i,l*r]};numbers.basic.modInverse=function(n,t){var i=numbers.basic.egcd(n,t);if(i[0]!==1)throw new Error("No modular inverse exists");return i[1]%t};numbers.basic.numbersEqual=function(n,t,i){if(typeof n!="number"||typeof t!="number"||typeof i!="number")throw new Error("First and Second must be numbers.");return n-t<i&&n-t>-i};numbers.basic.fallingFactorial=function(n,t){var i=n-t+1,r=1;if(n<0)throw new Error("n cannot be negative.");if(t>n)throw new Error("k cannot be greater than n.");while(i<=n)r*=i++;return r};numbers.basic.permutation=function(n,t){if(n<=0)throw new Error("n cannot be less than or equal to 0.");if(n<t)throw new Error("k cannot be greater than k.");var i=numbers.basic.binomial(n,t);return i*numbers.basic.factorial(t)};numbers.calculus={pointDiff:null,Riemann:null,adaptiveSimpson:null,limit:null,StirlingGamma:null,LanczosGamma:null,MonteCarlo:null};numbers.calculus.pointDiff=function(n,t){var i=n(t-.001),r=n(t+.001);return(r-i)/.002};numbers.calculus.Riemann=function(n,t,i,r,u){var e=(i-t)/r,o=0,f;if(typeof u=="function")for(f=t;f<i;f+=e)o+=n(u(f,f+e));else for(f=t;f<i;f+=e)o+=n(f);return o*e};numbers.calculus.adaptiveSimpson=function(n,t,i,r){return r=typeof r=="undefined"?numbers.EPSILON:r,SimpsonRecursive(n,t,i,SimpsonDef(n,t,i),r)};numbers.calculus.limit=function(n,t,i){if(i==="left")return n(t-1e-15);if(i==="right")return n(t+1e-15);if(i==="middle")return(numbers.calculus.limit(n,t,"left")+numbers.calculus.limit(n,t,"right"))/2;throw new Error("Approach not provided");};numbers.calculus.StirlingGamma=function(n){return Math.sqrt(2*Math.PI/n)*Math.pow(n/Math.E,n)};numbers.calculus.LanczosGamma=function(n){var i=[.99999999999980993,676.5203681218851,-1259.1392167224028,771.32342877765313,-176.61502916214059,12.507343278686905,-.13857109526572012,99843695780195716e-22,15056327351493116e-23],t,r,u;if(n<.5)return Math.PI/(Math.sin(Math.PI*n)*numbers.calculus.LanczosGamma(1-n));for(n-=1,r=i[0],u=n+7+.5,t=1;t<i.length;t++)r+=i[t]/(n+t);return Math.sqrt(2*Math.PI)*Math.pow(u,n+.5)*Math.exp(-u)*r};numbers.calculus.MonteCarlo=function(n,t){var i,r,u,f;if(arguments.length<2)throw new Error("Please enter at least one interval.");else if(t<=0)throw new Error("Please use a positive integer for N.");for(i=[],t=Math.ceil(t),r=2;r<arguments.length;r++)i.push(arguments[r]);return u=i.map(function(n){return n[1]-n[0]}).reduce(function(n,t){return n*t})/t,f=numbers.matrix.transpose(i.map(function(n){return numbers.statistic.randomSample(n[0],n[1],t)})).map(function(t){return n.apply(null,[t[0],t[1],t[2]])}),u*f.reduce(function(n,t){return n+t})};numbers.complex=function(n,t){this.re=n;this.im=t;this.r=this.magnitude();this.t=this.phase()};numbers.complex.prototype.add=function(n){return new numbers.complex(this.re+n.re,this.im+n.im)};numbers.complex.prototype.subtract=function(n){return new numbers.complex(this.re-n.re,this.im-n.im)};numbers.complex.prototype.multiply=function(n){var t=this.re*n.re-this.im*n.im,i=this.im*n.re+this.re*n.im;return new numbers.complex(t,i)};numbers.complex.prototype.divide=function(n){var t=n.re*n.re+n.im*n.im,i=(this.re*n.re+this.im*n.im)/t,r=(this.im*n.re-this.re*n.im)/t;return new numbers.complex(i,r)};numbers.complex.prototype.magnitude=function(){return Math.sqrt(this.re*this.re+this.im*this.im)};numbers.complex.prototype.phase=function(){return Math.atan2(this.im,this.re)};numbers.complex.prototype.conjugate=function(){return new numbers.complex(this.re,-1*this.im)};numbers.complex.prototype.pow=function(n){var t=Math.pow(this.magnitude(),n);return new numbers.complex(t*Math.cos(n*this.phase()),t*Math.sin(n*this.phase()))};numbers.complex.prototype.complexPow=function(n){var t=Math.pow(this.re,2)+Math.pow(this.im,2),i=Math.pow(t,n.re/2)*Math.pow(Math.E,-n.im*this.phase()),r=n.re*this.phase()+.5*n.im*Math.log(t);return new numbers.complex(i*Math.cos(r),i*Math.sin(r))};numbers.complex.prototype.roots=function(n){for(var i,r,u=new Array(n),t=0;t<n;t++)i=(this.phase()+2*Math.PI*t)/n,r=Math.pow(this.magnitude(),1/n),u[t]=new numbers.complex(r*Math.cos(i),r*Math.sin(i));return u};numbers.complex.prototype.sin=function(){var n=new numbers.complex(Math.E,0),t=new numbers.complex(0,1),i=new numbers.complex(0,-1),r=n.complexPow(t.multiply(this)).subtract(n.complexPow(i.multiply(this)));return r.divide(new numbers.complex(0,2))};numbers.complex.prototype.cos=function(){var n=new numbers.complex(Math.E,0),t=new numbers.complex(0,1),i=new numbers.complex(0,-1),r=n.complexPow(t.multiply(this)).add(n.complexPow(i.multiply(this)));return r.divide(new numbers.complex(2,0))};numbers.complex.prototype.tan=function(){return this.sin().divide(this.cos())};numbers.complex.prototype.equals=function(n,t){return numbers.basicnumbersEqual(this.re,numbers.complex.re,t)&&numbers.basicnumbersEqual(this.im,numbers.complex.im,t)};numbers.dsp={segment:null,fft:null};numbers.dsp.segment=function(n,t,i){for(var u=[],r=t;r<n.length;r+=i)u.push(n[r]);return u};numbers.dsp.fft=function(n){var i=n.length,t,u,f;if(i<=1)return[new numbers.complex(n[0],0)];if(Math.log(i)/Math.LN2%1!=0)throw new Error("Array length must be integer power of 2");var e=numbers.dsp.fft(numbers.dsp.segment(n,0,2)),o=numbers.dsp.fft(numbers.dsp.segment(n,1,2)),s=[],r=i/2;for(t=0;t<i;t++)u=-2*Math.PI*t/i,f=new numbers.complex(Math.cos(u),Math.sin(u)),s[t]=t<r?e[t].add(f.multiply(o[t])):e[t-r].subtract(f.multiply(o[t-r]));return s};numbers.generate={fibonacci:null,collatz:null};numbers.generate.fibonacci=function(n){var f,o;if(!isNaN(n)){var s=function(n){for(var t,i=[];n>0;)t=n<2?n:n%2,n=Math.floor(n/2),i.unshift(t);return i},i=1,t=0,u=1,e=s(n),r;for(f=0;f<e.length;f++)o=e[f],o?(r=[(i+u)*t,t*t+u*u],i=r[0],t=r[1]):(r=[i*i+t*t,(i+u)*t],i=r[0],t=r[1]),u=i+t;return t}};numbers.generate.collatz=function(n){if(!isNaN(n)){var t=[];return t.push(n),function i(n){n!==1&&(n%2==0?t.push(n/2):t.push(3*n+1),i(t[t.length-1]))}(n),t}};numbers.matrix={_check2DVector:null,deepCopy:null,isSquare:null,addition:null,subtraction:null,scalar:null,transpose:null,identity:null,dotproduct:null,multiply:null,determinant:null,lupDecomposition:null,rotate:null,scale:null,shear:null,affine:null,rowScale:null,rowSwitch:null,rowAddMultiple:null,GaussJordanEliminate:null,rowReduce:null,inverse:null,getCol:null,reorderRows:null,reorderCols:null,reverseRows:null,reverseCols:null,zeros:null,zigzag:null,vectorNorm:null,matrixNorm:null,isUpperBand:null,isLowerBand:null,isRowDD:null,isStrictlyRowDD:null,isColumnDD:null,isStrictlyColumnDD:null,map:null,mapMulti:null};ERROR_MATRIX_NOT_SQUARE="Matrix must be square.";ERROR_VECTOR_NOT_2D="Only two dimensional operations are supported at this time.";numbers.matrix._check2DVector=function(n){if(n.length!==2)throw new Error(ERROR_VECTOR_NOT_2D);};numbers.matrix.deepCopy=function(n){var i,t;if(Array.isArray(n)){if(n[0][0]===undefined)throw new Error("Input cannot be a vector.");}else throw new Error("Input must be a numbers.matrix.");for(i=new Array(n.length),t=0;t<n.length;t++)i[t]=n[t].slice();return i};numbers.matrix.isSquare=function(n){var i,t;if(Array.isArray(n)){if(n[0][0]===undefined)throw new Error("Input cannot be a vector.");}else throw new Error("Input must be a numbers.matrix.");for(i=n.length,t=0;t<i;t++)if(n[t].length!==i)return!1;return!0};numbers.matrix.addition=function(n,t){var u,i,r;if(n.length!==t.length||n[0].length!==t[0].length)throw new Error("Matrix mismatch");if(u=new Array(n.length),n[0].length)for(i=0;i<n.length;i++)for(u[i]=new Array(n[i].length),r=0;r<n[i].length;r++)u[i][r]=n[i][r]+t[i][r];else for(i=0;i<n.length;i++)u[i]=n[i]+t[i];return u};numbers.matrix.subtraction=function(n,t){var u,i,r;if(n.length!==t.length||n[0].length!==t[0].length)throw new Error("Matrix mismatch");if(u=new Array(n.length),n[0].length)for(i=0;i<n.length;i++)for(u[i]=new Array(n[i].length),r=0;r<n[i].length;r++)u[i][r]=n[i][r]-t[i][r];else for(i=0;i<n.length;i++)u[i]=n[i]-t[i];return u};numbers.matrix.scalar=function(n,t){for(var r,u=numbers.matrix.deepCopy(n),i=0;i<u.length;i++)for(r=0;r<u[i].length;r++)u[i][r]=t*n[i][r];return u};numbers.matrix.transpose=function(n){for(var i,r=new Array(n[0].length),t=0;t<n[0].length;t++)for(r[t]=new Array(n.length),i=0;i<n.length;i++)r[t][i]=n[i][t];return r};numbers.matrix.identity=function(n){for(var i,r=new Array(n),t=0;t<n;t++)for(r[t]=new Array(n),i=0;i<n;i++)r[t][i]=t===i?1:0;return r};numbers.matrix.dotproduct=function(n,t){var r,i;if(n.length!==t.length)throw new Error("Vector mismatch");for(r=0,i=0;i<n.length;i++)r+=n[i]*t[i];return r};numbers.matrix.multiply=function(n,t){var i,f,e,r,u;if(n[0].length!==t.length)throw new Error("Matrix mismatch");for(i=new Array(n.length),f=0;f<n.length;f++)i[f]=new Array(t[0].length);for(e=numbers.matrix.transpose(t),r=0;r<i.length;r++)for(u=0;u<i[r].length;u++)i[r][u]=numbers.matrix.dotproduct(n[r],e[u]);return i};numbers.matrix.determinant=function(n){var u=n.length,t=n[0].length,o=0,i,r,f,e;if(!numbers.matrix.isSquare(n))throw new Error(ERROR_MATRIX_NOT_SQUARE);if(u===1)return n[0][0];if(u===2)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(r=0;r<t;r++){for(f=n[0][r],e=n[0][r],i=1;i<u;i++)e*=n[i][((r+i)%t+t)%t],f*=n[i][((r-i)%t+t)%t];o+=e-f}return o};numbers.matrix.lupDecomposition=function(n){var i,t,l,c,o,f;if(!numbers.matrix.isSquare(n))throw new Error(ERROR_MATRIX_NOT_SQUARE);var u=n.length,r=numbers.matrix.deepCopy(n),s=numbers.matrix.transpose(numbers.matrix.identity(u)),h,e=new Array(u);for(this.getL=function(n){for(var t,r=n[0].length,u=numbers.matrix.identity(r),i=0;i<r;i++)for(t=0;t<r;t++)i>t&&(u[i][t]=n[i][t]);return u},this.getU=function(n){for(var t,r=n[0].length,u=numbers.matrix.identity(r),i=0;i<r;i++)for(t=0;t<r;t++)i<=t&&(u[i][t]=n[i][t]);return u},i=0;i<u;i++){for(t=0;t<u;t++)e[t]=r[t][i];for(t=0;t<u;t++){for(h=r[t],l=Math.min(t,i),c=0,o=0;o<l;o++)c+=h[o]*e[o];h[i]=e[t]-=c}for(f=i,t=i+1;t<u;t++)Math.abs(e[t])>Math.abs(e[f])&&(f=t);if(f!==i&&(r=numbers.matrix.rowSwitch(r,f,i),s=numbers.matrix.rowSwitch(s,f,i)),i<u&&r[i][i]!==0)for(t=i+1;t<u;t++)r[t][i]/=r[i][i]}return[this.getL(r),this.getU(r),s]};numbers.matrix.rotate=function(n,t,i){numbers.matrix._check2DVector(n);var u=i==="clockwise"?-1:1,r=t*(Math.PI/180),f=[[Math.cos(r),-1*u*Math.sin(r)],[u*Math.sin(r),Math.cos(r)]];return numbers.matrix.multiply(f,n)};numbers.matrix.scale=function(n,t,i){numbers.matrix._check2DVector(n);var r=[[t,0],[0,i]];return numbers.matrix.multiply(r,n)};numbers.matrix.shear=function(n,t,i){numbers.matrix._check2DVector(n);var r=i==="xaxis"?t:0,u=i==="yaxis"?t:0,f=[[1,r],[u,1]];return numbers.matrix.multiply(f,n)};numbers.matrix.affine=function(n,t,i){numbers.matrix._check2DVector(n);var u=[[1,0,t],[0,1,i],[0,0,1]],f=[[n[0][0]],[n[1][0]],[1]],r=numbers.matrix.multiply(u,f);return[[r[0][0]],[r[1][0]]]};numbers.matrix.rowScale=function(n,t,i){for(var u,f=new Array(n.length),r=0;r<n.length;r++)for(f[r]=new Array(n[r].length),u=0;u<n[r].length;u++)f[r][u]=r===t?i*n[r][u]:n[r][u];return f};numbers.matrix.rowSwitch=function(n,t,i){for(var u,f=new Array(n.length),r=0;r<n.length;r++)for(f[r]=new Array(n[r].length),u=0;u<n[r].length;u++)f[r][u]=r===t?n[i][u]:r===i?n[t][u]:n[r][u];return f};numbers.matrix.rowAddMultiple=function(n,t,i,r){for(var f,e=new Array(n.length),u=0;u<n.length;u++)for(e[u]=new Array(n[u].length),f=0;f<n[u].length;f++)u===i?e[i][f]=n[i][f]+r*n[t][f]:e[u][f]=n[u][f];return e};numbers.matrix.GaussJordanEliminate=function(n,t){for(var c=typeof t=="undefined"?1e-10:t,e=n.length,s=n[0].length,i=-1,r,u,f,o,h;++i<e;){for(o=i,r=i;++r<e;)Math.abs(n[r][i])>Math.abs(n[o][i])&&(o=r);if(h=n[i],n[i]=n[o],n[o]=h,Math.abs(n[i][i])<=c)return n;for(r=i;++r<e;)for(f=n[r][i]/n[i][i],u=i-1;++u<s;)n[r][u]-=n[i][u]*f}for(i=e;--i>=0;){for(f=n[i][i],r=-1;++r<i;)for(u=s;--u>=i;)n[r][u]-=n[i][u]*n[r][i]/f;for(n[i][i]/=f,u=e-1;++u<s;)n[i][u]/=f}return n};numbers.matrix.rowReduce=function(n,t){return numbers.matrix.GaussJordanEliminate(n,t)};numbers.matrix.inverse=function(n){if(!numbers.matrix.isSquare(n))throw new Error(ERROR_MATRIX_NOT_SQUARE);for(var i=n.length,r=numbers.matrix.identity(i),t=0;t<i;t++)n[t]=n[t].concat(r[t]);for(n=numbers.matrix.GaussJordanEliminate(n),t=0;t<i;t++)n[t]=n[t].slice(i);return n};numbers.matrix.getCol=function(n,t){var r=new Array(n.length),i;if(t<0)throw new Error("The specified column must be a positive integer.");else if(t>=n[0].length)throw new Error("The specified column must be between 0 and the number of columns - 1.");for(i=0;i<n.length;i++)r[i]=n[i][t];return r};numbers.matrix.reorderRows=function(n,t){var r=[],i;if(t===undefined)throw new Error("A reordering array must be entered.");else if(t.length!==n.length)throw new Error("The reordered matrix must have the same number of rows as the original numbers.matrix.");for(i=0;i<t.length;i++)if(t[i]<0)throw new Error("The desired order of the rows must be positive integers.");else if(t[i]>=t.length)throw new Error("The desired order of the rows must start at 0 and end at the number of rows - 1.");else r.push(n[t[i]]);return r};numbers.matrix.reorderCols=function(n,t){var r=[],i;if(t===undefined)throw new Error("Please enter a desired reordering array.");else if(t.length!==n[0].length)throw new Error("The reordered matrix must have the same number of columns as the original numbers.matrix.");for(i=0;i<t.length;i++)if(t[i]<0)throw new Error("The desired order of the columns must be positive integers.");else if(t[i]>=t.length)throw new Error("The desired order of the columns must start at 0 and end at the number of columns - 1.");else r.push(numbers.matrix.getCol(n,t[i]));return numbers.matrix.transpose(r)};numbers.matrix.reverseRows=function(n){for(var i=[],t=n.length-1;t>-1;t--)i.push(t);return numbers.matrix.reorderRows(n,i)};numbers.matrix.reverseCols=function(n){for(var i=[],t=n.length-1;t>-1;t--)i.push(t);return numbers.matrix.reorderCols(n,i)};numbers.matrix.zeros=function(n,t){var f=new Array(n),i,u,r;if(n<1||t<1)throw new Error("The matrix dimensions must be positive integers.");for(n=Math.ceil(n),t=Math.ceil(t),i=0;i<n;i++){for(u=new Array(t),r=0;r<t;r++)u[r]=0;f[i]=u}return f};numbers.matrix.zigzag=function(n,t,i){if(n<=1)throw new Error("Matrix size must be at least 2x2.");n=Math.ceil(n);var r=numbers.matrix.zeros(n,n),u=function(t){var c=!1,s=n*n,h=1,l=1,r,u,f,i,o,e;for(t[0][0]=s,t[n-1][n-1]=h,i=1;i<n;i++)c?(s-=4*l,h+=4*l,l++):(s--,h++),t[0][i]=s,t[n-1][n-1-i]=h,c=!c;for(e=!0,i=1;i<n;i++){for(r=0,u=i,f=t[r][u],o=1;o<i+1;o++)e?f-=1:f+=1,r++,u--,t[r][u]=f;e=!e}for(e=n%2==0?!0:!1,i=1;i<n-1;i++){for(r=n-1,u=i,f=t[r][u],o=1;o<n-i;o++)e?f--:f++,r--,u++,t[r][u]=f;e=!e}return t},f=function(n){return numbers.matrix.transpose(u(n))},e=function(n){return numbers.matrix.reverseCols(u(n))},h=function(n){return numbers.matrix.reverseRows(s(e(n)))},c=function(n){return numbers.matrix.reverseRows(u(n))},l=function(n){return numbers.matrix.reverseRows(f(n))},o=function(n){return numbers.matrix.reverseCols(numbers.matrix.reverseRows(u(n)))},s=function(n){return numbers.matrix.transpose(o(n))};if(t==="BR"&&i==="H")return u(r);if(t==="BR"&&i==="V")return f(r);if(t==="BL"&&i==="H")return e(r);if(t==="BL"&&i==="V")return h(r);if(t==="TR"&&i==="H")return c(r);if(t==="TR"&&i==="V")return l(r);if(t==="TL"&&i==="H")return o(r);if(t==="TL"&&i==="V")return s(r);throw new Error("Enter the direction (V,H) and corner (BR,BL,TR,TL) correctly.");};numbers.matrix.vectorNorm=function(n,t){if(Array.isArray(n)&&n.length!==0){if(typeof t!="undefined"&&typeof t!="number")throw new Error("Norm order must be a number.");}else throw new Error("Vector must be an array of at least length 1.");t=typeof t=="undefined"?2:t;var f=n.length,r=0,u,i;switch(t){case Infinity:for(i=0;i<f;i++)u=Math.abs(n[i]),u>r&&(r=u);break;case-Infinity:for(r=Infinity,i=0;i<f;i++)u=Math.abs(n[i]),u<r&&(r=u);break;default:for(i=0;i<f;i++)r+=Math.pow(Math.abs(n[i]),t);r=Math.pow(r,1/t)}return r};numbers.matrix.matrixNorm=function(n,t){if(Array.isArray(n)&&n.length!==0&&Array.isArray(n[0])){if(typeof t!="undefined"&&typeof t!="number"&&t!==null)throw new Error("Norm order must be a number or null.");}else throw new Error("Matrix must be an array of at least length 1.");t=typeof t=="undefined"?null:t;var e=n.length,o=n[0].length,u=0,f,i,r;switch(t){case Infinity:for(i=0;i<e;i++){for(f=0,r=0;r<o;r++)f+=Math.abs(n[i][r]);f>u&&(u=f)}break;case-Infinity:for(u=Infinity,i=0;i<e;i++){for(f=0,r=0;r<o;r++)f+=Math.abs(n[i][r]);f<u&&(u=f)}break;case 1:for(i=0;i<o;i++){for(f=0,r=0;r<e;r++)f+=Math.abs(n[r][i]);f>u&&(u=f)}break;case-1:for(u=Infinity,i=0;i<o;i++){for(f=0,r=0;r<e;r++)f+=Math.abs(n[r][i]);f<u&&(u=f)}break;case null:for(i=0;i<e;i++)for(r=0;r<o;r++)u+=Math.pow(n[i][r],2);u=Math.pow(u,.5);break;case 2:throw new Error("Singular values are not yet supported in numbers.js.");case-2:throw new Error("Singular values are not yet supported in numbers.js.");default:for(i=0;i<e;i++)for(r=0;r<o;r++)u+=Math.pow(Math.abs(n[i][r]),t);u=Math.pow(u,1/t)}return u};numbers.matrix.isUpperBand=function(n,t){var i;if(!Array.isArray(n)||!Array.isArray(n[0])||n.length<2)throw new Error("Matrix must be an array of at least dimension 2.");else if(typeof t!="number"||t<0||t%1!=0)throw new Error("Upper bandwidth must be a nonzero integer.");var r=!0,f=n[0].length,u=0;for(i=t+1;i<f;i++){if(n[u][i]!==0){r=!1;break}u++}return r};numbers.matrix.isLowerBand=function(n,t){var i;if(!Array.isArray(n)||!Array.isArray(n[0])||n.length<2)throw new Error("Matrix must be an array of at least dimension 2.");else if(typeof t!="number"||t<0||t%1!=0)throw new Error("Lower bandwidth must be a nonzero integer.");var r=!0,f=n.length,u=0;for(i=t+1;i<f;i++){if(n[i][u]!==0){r=!1;break}u++}return r};sumNondiagonalElements=function(n,t){for(var r=0,i=0;i<t;i++)r+=Math.abs(n[i]);for(i=t+1;i<n.length;i++)r+=Math.abs(n[i]);return r};numbers.matrix.isRowDD=function(n){var r=n.length,t;if(!numbers.matrix.isSquare(n))throw new Error(ERROR_MATRIX_NOT_SQUARE);for(t=0;t<r;t++){var i=n[t],u=i[t],f=sumNondiagonalElements(i,t);if(Math.abs(u)<f)return!1}return!0};numbers.matrix.isStrictlyRowDD=function(n){var i,t;if(!numbers.matrix.isSquare(n))throw new Error(ERROR_MATRIX_NOT_SQUARE);for(i=n.length,t=0;t<i;t++){var r=n[t],u=r[t],f=sumNondiagonalElements(r,t);if(Math.abs(u)<=f)return!1}return!0};numbers.matrix.isColumnDD=function(n){var i,t;if(!numbers.matrix.isSquare)throw new Error(ERROR_MATRIX_NOT_SQUARE);for(i=n.length,t=0;t<i;t++){var r=numbers.matrix.getCol(n,t),u=r[t],f=sumNondiagonalElements(r,t);if(Math.abs(u)<f)return!1}return!0};numbers.matrix.isStrictlyColumnDD=function(n){var i,t;if(!numbers.matrix.isSquare(n))throw new Error(ERROR_MATRIX_NOT_SQUARE);for(i=n.length,t=0;t<i;t++){var r=numbers.matrix.getCol(n,t),u=r[t],f=sumNondiagonalElements(r,t);if(Math.abs(u)<=f)return!1}return!0};numbers.matrix.map=function(n,t){for(var f=n.length,e=n[0].length,r,u=numbers.matrix.deepCopy(n),i=0;i<f;i++)for(r=0;r<e;r++)u[i][r]=t(n[i][r]);return u};numbers.matrix.mapMulti=function(n,t){for(var u=new Array(Object.keys(arguments).length-1),f=1;f<u.length;f++)u[f]=arguments[f+1];for(var o=n.length,s=n[0].length,r,e=numbers.matrix.deepCopy(n),i=0;i<o;i++)for(r=0;r<s;r++)u[0]=n[i][r],e[i][r]=t.apply(null,u);return e};numbers.prime={simple:null,factorization:null,millerRabin:null,sieve:null,coprime:null,getPerfectPower:null,getPrimePower:null};numbers.prime.simple=function(n){if(isNaN(n)||!isFinite(n)||n%1||n<2)return!1;if(n%2==0)return n===2;if(n%3==0)return n===3;for(var t=5,i=Math.sqrt(n);t<=i;t+=6)if(n%t==0||n%(t+2)==0)return!1;return!0};numbers.prime.factorization=function(n){n=Math.floor(n);for(var i,r=[],t,f=Math.sqrt,u=1<n&&isFinite(n);u;){if(i=f(n),t=2,n%t)for(t=3;n%t&&(t+=2)<i;)continue;t=i<t?n:t;r.push(t);u=t!==n;n/=t}return r};numbers.prime.millerRabin=function(n,t){var r,i,e,u,o;if(arguments.length===1&&(t=20),n===2)return!0;if(!numbers.basic.isInt(n)||n<=1||n%2==0)return!1;for(r=0,i=n-1;;){var f=numbers.basic.divMod(i,2),s=f[0],h=f[1];if(h===1)break;r+=1;i=s}for(e=function(t){if(numbers.basic.powerMod(t,i,n)===1)return!1;for(var u=0;u<r;u++)if(numbers.basic.powerMod(t,Math.pow(2,u)*i,n)===n-1)return!1;return!0},u=0;u<t;u++)if(o=2+Math.floor(Math.random()*(n-4)),e(o))return!1;return!0};numbers.prime.sieve=function(n){var t,i,u,r;if(n<2)return[];for(t=[2],i=3;i<=n;i++){r=!1;for(u in t)t.hasOwnProperty(u)&&(r=r||0==i%t[u]);r||t.push(i)}return t};numbers.prime.coprime=function(n,t){return numbers.basic.gcd(n,t)===1};numbers.prime.getPerfectPower=function(n){var t=numbers.prime.getPrimePower(n);return t&&t[1]>1?t:!1};numbers.prime.getPrimePower=function(n){var t,f,i,r,u;if(n<2)return!1;if(numbers.prime.millerRabin(n))return[n,1];if(n%2==0)return[2,n.toString(2).length-1];if(t=numbers.prime.factorization(n),!t)return!1;for(f=t.length,i=0;i<f;i++)for(r=0,u=0;r<=n;){if(r=Math.pow(t[i],u),r/n==1)return[t[i],u];u++}return!1};rGen=Math.random;numbers.random={setGenerator:null,sample:null,boxMullerTransform:null,irwinHall:null,bates:null,distribution:{normal:null,logNormal:null,boxMuller:null,irwinHall:null,irwinHallNormal:null,bates:null}};numbers.random.setGenerator=function(n){if(typeof n!="function")throw new Error("Must pass a function");rGen=n};numbers.random.sample=function(n,t,i){var u=[],r;for(u.length=i,r=0;r<i;r++)u[r]=n+(t-n)*rGen();return u};numbers.random.boxMullerTransform=function(n,t){var i,r,u;arguments.length<=1&&(t=1);arguments.length===0&&(n=0);i=0;r=0;do i=rGen()*2-1,r=rGen()*2-1,u=i*i+r*r;while(u===0||u>1);var o=Math.sqrt(-2*Math.log(u)/u),f=i*o,e=r*o;return f=n+f*t,e=n+e*t,[f,e]};numbers.random.irwinHall=function(n,t){var i,r;for(arguments.length===1&&(t=0),i=0,r=0;r<n;r++)i+=rGen();return i-t};numbers.random.bates=function(n,t,i){var r,u;for(arguments.length<=2&&(i=0),arguments.length===1&&(t=1),r=0,u=0;u<n;u++)r+=(t-i)*rGen()+i;return r/n};numbers.random.distribution.normal=function(n,t,i){return arguments.length<=2&&(i=1),arguments.length===1&&(t=0),numbers.random.distribution.boxMuller(n,t,i)};numbers.random.distribution.logNormal=function(n,t,i){arguments.length<=2&&(i=1);arguments.length===1&&(t=0);var r=function(n){return Math.exp(n)};return numbers.random.distribution.boxMuller(n,t,i).map(r)};numbers.random.distribution.boxMuller=function(n,t,i,r){var u,f,e;for(arguments.length<=3&&(r=!1),arguments.length<=2&&(i=1),arguments.length===1&&(t=0),u=[],f=0;f<n;f++)e=numbers.random.boxMullerTransform(t,i),u.push(r?e:e[0]);return u};numbers.random.distribution.irwinHall=function(n,t,i){var u,r;for(arguments.length<=2&&(i=0),arguments.length===1&&(t=n),u=new Array(n),r=0;r<n;r++)u[r]=numbers.random.irwinHall(t,i);return u};numbers.random.distribution.irwinHallNormal=function(n){return numbers.random.distribution.irwinHall(n,12,6)};numbers.random.distribution.bates=function(n,t,i){var u,r;for(arguments.length<=2&&(i=0),arguments.length===1&&(t=n),u=new Array(n),r=0;r<n;r++)u[r]=numbers.random.bates(n,t,i);return u};numbers.statistic={mean:null,median:null,mode:null,quantile:null,report:null,standardDev:null,correlation:null,rSquared:null,exponentialRegression:null,linearRegression:null,covariance:null};numbers.statistic.mean=function(n){var t=n.length,i=numbers.basic.sum(n);return i/t};numbers.statistic.median=function(n){return numbers.statistic.quantile(n,1,2)};numbers.statistic.mode=function(n){for(var r,u,t={},i=0,f=n.length;i<f;i++)t[n[i]]===undefined?t[n[i]]=0:t[n[i]]++;for(u in t)t.hasOwnProperty(u)&&(r===undefined||t[u]>t[r])&&(r=u);return Number(r)};numbers.statistic.quantile=function(n,t,i){var r,f,u;return t===0?Math.min.apply(null,n):t===i?Math.max.apply(null,n):(r=n.slice(0),r.sort(function(n,t){return n-t}),f=r.length,u=f*t/i,u%1==0)?.5*r[u-1]+.5*r[u]:r[Math.floor(u)]};numbers.statistic.report=function(n){return{mean:numbers.statistic.mean(n),firstQuartile:numbers.statistic.quantile(n,1,4),median:numbers.statistic.median(n),thirdQuartile:numbers.statistic.quantile(n,3,4),standardDev:numbers.statistic.standardDev(n)}};numbers.statistic.standardDev=function(n){for(var r=n.length,u=numbers.statistic.mean(n),i=[],t=0;t<n.length;t++)i[t]=Math.pow(n[t]-u,2);return Math.sqrt(1/r*numbers.basic.sum(i))};numbers.statistic.correlation=function(n,t){if(n.length===t.length){var i=numbers.statistic.covariance(n,t),r=numbers.statistic.standardDev(n),u=numbers.statistic.standardDev(t);return i/(r*u)}throw new Error("Array mismatch");};numbers.statistic.rSquared=function(n,t){var i=numbers.basic.sum(n.map(function(n,i){return numbers.basic.square(n-t[i])})),r=numbers.basic.sum(n.map(function(t){return numbers.basic.square(t-numbers.statistic.mean(n))}));return 1-i/r};numbers.statistic.exponentialRegression=function(n){var i=n.length,r=numbers.basic.range(1,i),t=numbers.basic.sum(r),e=n.map(function(n){return Math.log(n)}),l=r.map(function(n){return n*n}),u=numbers.basic.sum(l),o=numbers.basic.sum(e),a=r.map(function(n,t){return n*e[t]}),s=numbers.basic.sum(a),h=(o*u-t*s)/(i*u-t*t),c=(i*s-t*o)/(i*u-t*t),f=function(n){return typeof n=="number"?Math.exp(h)*Math.exp(c*n):n.map(function(n){return Math.exp(h)*Math.exp(c*n)})};return f.rSquared=numbers.statistic.rSquared(n,r.map(f)),f};numbers.statistic.linearRegression=function(n,t){var u=n.length,i=numbers.basic.sum(n),e=numbers.basic.sum(t),o=numbers.basic.sum(n.map(function(n,i){return n*t[i]})),s=numbers.basic.sum(n.map(function(n){return n*n})),h=numbers.statistic.mean(n),c=numbers.statistic.mean(t),r=(o-1/u*i*e)/(s-1/u*i*i),f=c-r*h;return function(n){return typeof n=="number"?f+r*n:n.map(function(n){return f+r*n})}};numbers.statistic.covariance=function(n,t){var i;if(n.length===t.length){var r=n.length,u=0,f=numbers.basic.sum(n),e=numbers.basic.sum(t);for(i=0;i<r;i++)u+=n[i]*t[i];return(u-f*e/r)/r}throw new Error("Array mismatch");};